<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>氷が溶ける集中体験</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
        }

        #glass {
            position: relative;
            width: 180px;
            height: 260px;
            border: 4px solid #000;
            margin: 30px auto;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }

        .ice {
            position: absolute;
            background: linear-gradient(to top, #cfefff, #ffffff);
            border-radius: 10px;
            transition: height 0.2s linear, bottom 0.2s linear, background 0.2s linear, border-radius 0.2s linear;
        }

        .melting {
            background: linear-gradient(to top, #7fcfff, #e8f8ff);
            border-radius: 16px;
            animation: meltWiggle 0.6s infinite alternate;
        }

        @keyframes meltWiggle {
            from {
                transform: translateX(-1px);
            }

            to {
                transform: translateX(1px);
            }
        }

        .drop {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #7fcfff;
            border-radius: 50%;
            animation: dropFall 0.6s linear forwards;
        }

        @keyframes dropFall {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(30px);
            }
        }

        #controls {
            margin-bottom: 10px;
        }

        #message {
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <h2>氷が溶けるまで集中</h2>
    <div id="controls"> 氷の数： <input type="range" id="iceCount" min="1" max="8" value="5"> <span id="countLabel">5</span>
        <button onclick="start()">スタート</button> </div>
    <div id="glass"></div>
    <div id="message"></div>
    <script> const glass = document.getElementById("glass"); const message = document.getElementById("message"); const iceCountInput = document.getElementById("iceCount"); const countLabel = document.getElementById("countLabel"); let ices = []; let timer; iceCountInput.addEventListener("input", () => { countLabel.textContent = iceCountInput.value; }); function start() {
            glass.innerHTML = ""; message.textContent = ""; clearInterval(timer); ices = []; const iceCount = parseInt(iceCountInput.value); for (let i = 0; i < iceCount; i++) {
                const ice = document.createElement("div"); ice.className = "ice";
                const height = Math.floor(Math.random() * 40) + 30; const width = Math.floor(Math.random() * 60) + 60; const left = Math.floor(Math.random() * (180 - width)); ice.style.height = height + "px"; ice.style.width = width + "px"; ice.style.left = left + "px"; 
                // ゆっくり・ズレのある溶け方 
                ice.meltSpeed = Math.random() * 0.08 + 0.02; glass.appendChild(ice); ices.push(ice); } stackIces(); timer = setInterval(melt, 200); } function melt() { 
                // 今溶けている氷を1つ選ぶ 
                ices.forEach(i => i.classList.remove("melting")); const activeIce = ices[Math.floor(Math.random() * ices.length)]; let remaining = 0; ices.forEach(ice => { let h = parseFloat(ice.style.height); if (h > 0) { if (ice === activeIce) { ice.classList.add("melting"); h -= ice.meltSpeed * 3; createDrop(ice); } else { h -= ice.meltSpeed; } if (h < 0) h = 0; ice.style.height = h + "px"; } remaining += h; }); stackIces(); if (remaining <= 0) { clearInterval(timer); message.textContent = "氷がすべて溶けた。集中終了。";
            }
        } function stackIces() { let bottom = 0; ices.forEach(ice => { const h = parseFloat(ice.style.height); ice.style.bottom = bottom + "px"; bottom += h; }); } function createDrop(ice) { if (Math.random() > 0.3) return; const drop = document.createElement("div"); drop.className = "drop"; drop.style.left = ice.style.left; drop.style.bottom = ice.style.bottom; glass.appendChild(drop); setTimeout(() => drop.remove(), 600); } </script>
</body>

</html>