<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家計簿アプリ プロトタイプ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --color-base: #aa998a;
            --color-accent: #eadfca;
            --color-sub: #9ec3bc;
            --color-text: #4a4a4a;
        }

        body {
            background-color: var(--color-accent);
            color: var(--color-text);
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding-bottom: 100px;
        }

        .bg-base {
            background-color: var(--color-base);
        }

        .bg-accent {
            background-color: var(--color-accent);
        }

        .bg-sub {
            background-color: var(--color-sub);
        }

        .text-base {
            color: var(--color-base);
        }

        .text-sub {
            color: var(--color-sub);
        }

        .view-section {
            display: none;
        }

        .view-section.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nav-button.active {
            color: var(--color-base) !important;
        }

        input[type="date"],
        select {
            appearance: none;
            -webkit-appearance: none;
        }

        .chart-container {
            position: relative;
            margin: auto;
            height: 200px;
            width: 100%;
        }

        .chart-container-donut {
            height: 180px;
            width: 180px;
        }
    </style>
</head>

<body> <!-- Header -->
    <header class="p-6 text-white shadow-md rounded-b-[40px] sticky top-0 z-10 bg-base">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-xl font-bold tracking-wider">My Wallet</h1> <select id="global-month-selector"
                onchange="handleMonthChange()"
                class="bg-white/20 border-0 text-white text-sm rounded-full px-4 py-1 outline-none font-bold">
                <!-- Options generated by JS --> </select>
        </div>
        <div class="flex justify-between items-end">
            <div>
                <p class="text-xs opacity-80 mb-1">選択月の収支</p>
                <p id="total-balance" class="text-3xl font-bold">¥ 0</p>
            </div>
            <div class="text-right"> <i data-lucide="calendar" class="w-4 h-4 inline mr-1 opacity-70"></i> <span
                    id="display-month" class="text-xs font-bold opacity-90"></span> </div>
        </div>
    </header>
    <main class="p-5 max-w-md mx-auto"> <!-- Dashboard View (Monthly Focus) -->
        <section id="view-dashboard" class="view-section active space-y-5">
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-3xl shadow-sm border-l-4 border-sub">
                    <div class="flex items-center gap-2 mb-2 text-gray-400"> <i data-lucide="trending-up"
                            class="w-4 h-4 text-green-500"></i> <span
                            class="text-[10px] font-bold uppercase">Income</span> </div>
                    <p id="summary-income" class="text-lg font-bold">¥ 0</p>
                </div>
                <div class="bg-white p-4 rounded-3xl shadow-sm border-l-4 border-base">
                    <div class="flex items-center gap-2 mb-2 text-gray-400"> <i data-lucide="trending-down"
                            class="w-4 h-4 text-red-400"></i> <span
                            class="text-[10px] font-bold uppercase">Expense</span> </div>
                    <p id="summary-expense" class="text-lg font-bold">¥ 0</p>
                </div>
            </div> <!-- Doughnut Chart (Category) -->
            <div class="bg-white p-6 rounded-[32px] shadow-sm text-center">
                <h2 class="font-bold mb-4 flex items-center gap-2 text-left"> <i data-lucide="pie-chart"
                        class="w-5 h-5 text-sub"></i> 支出の内訳 </h2>
                <div class="chart-container chart-container-donut"> <canvas id="expenseChart"></canvas> </div>
                <div id="chart-legend"
                    class="mt-4 grid grid-cols-2 gap-2 text-[10px] font-bold text-gray-500 text-left"></div>
            </div>
            <div class="bg-white p-6 rounded-[32px] shadow-sm">
                <h2 class="font-bold mb-4 flex items-center gap-2"> <i data-lucide="list" class="w-5 h-5 text-base"></i>
                    今月の履歴
                </h2>
                <div id="recent-list" class="space-y-3"></div>
            </div>
        </section> <!-- Stats View (Monthly Trends) -->
        <section id="view-stats" class="view-section space-y-5">
            <div class="bg-white p-6 rounded-[32px] shadow-sm">
                <h2 class="font-bold mb-6 flex items-center gap-2"> <i data-lucide="bar-chart-3"
                        class="w-5 h-5 text-base"></i> 月別の支出推移 </h2>
                <div class="chart-container h-[220px]"> <canvas id="trendChart"></canvas> </div>
            </div>
            <div class="bg-white p-6 rounded-[32px] shadow-sm">
                <h2 class="font-bold mb-4 flex items-center gap-2"> <i data-lucide="calendar-days"
                        class="w-5 h-5 text-sub"></i> 月別収支一覧 </h2>
                <div id="monthly-summary-list" class="space-y-4"> <!-- JS --> </div>
            </div>
        </section> <!-- List View -->
        <section id="view-list" class="view-section space-y-4">
            <h2 class="text-lg font-bold px-2 flex items-center gap-2"> <i data-lucide="history" class="w-5 h-5"></i>
                全ての履歴 </h2>
            <div id="full-history-list" class="space-y-3"></div>
        </section> <!-- Add View -->
        <section id="view-add" class="view-section">
            <div class="bg-white p-6 rounded-[32px] shadow-xl border border-gray-50">
                <h2 class="text-xl font-bold mb-6 text-center">データを入力</h2>
                <form id="transaction-form" class="space-y-5">
                    <div class="flex p-1 bg-gray-100 rounded-2xl">
                        <button type="button" id="btn-type-expense" onclick="setFormType('expense')"
                            class="flex-1 py-2 rounded-xl text-sm font-bold bg-white shadow-sm">支出</button> <button
                            type="button" id="btn-type-income" onclick="setFormType('income')"
                            class="flex-1 py-2 rounded-xl text-sm font-bold text-gray-400">収入</button>
                    </div>
                    <div class="space-y-2"> <label
                            class="text-xs font-bold text-gray-400 flex items-center gap-1 ml-1">金額</label>
                        <div class="relative"> <span
                                class="absolute left-4 top-1/2 -translate-y-1/2 font-bold text-gray-400 text-xl">¥</span>
                            <input type="number" id="input-amount" placeholder="0" required
                                class="w-full pl-10 pr-4 py-4 bg-gray-50 rounded-2xl text-2xl font-bold focus:ring-2 focus:ring-sub outline-none">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2"> <label
                                class="text-xs font-bold text-gray-400 flex items-center gap-1 ml-1 text-[10px]">カテゴリ</label>
                            <select id="input-category"
                                class="w-full p-3 bg-gray-50 rounded-xl text-sm outline-none border-0 ring-1 ring-gray-100"></select>
                        </div>
                        <div class="space-y-2"> <label
                                class="text-xs font-bold text-gray-400 flex items-center gap-1 ml-1 text-[10px]">日付</label>
                            <input type="date" id="input-date"
                                class="w-full p-3 bg-gray-50 rounded-xl text-sm outline-none border-0 ring-1 ring-gray-100">
                        </div>
                    </div>
                    <div class="space-y-2"> <label
                            class="text-xs font-bold text-gray-400 flex items-center gap-1 ml-1 text-[10px]">メモ</label>
                        <input type="text" id="input-memo" placeholder="備考など"
                            class="w-full p-3 bg-gray-50 rounded-xl text-sm outline-none border-0 ring-1 ring-gray-100">
                    </div>
                    <button type="submit"
                        class="w-full py-4 mt-4 rounded-2xl text-white font-bold text-lg shadow-lg bg-base transition-transform active:scale-[0.98]">
                        保存する </button>
                </form>
            </div>
        </section>
    </main> <!-- Floating Action Button (FAB) --> <button onclick="switchView('add')" id="fab-add"
        class="fixed bottom-24 right-6 w-16 h-16 rounded-full shadow-2xl text-white bg-base flex items-center justify-center z-30 transition-all hover:scale-110 active:scale-90 border-4 border-white">
        <i data-lucide="plus" class="w-8 h-8"></i> </button> <!-- Navigation -->
    <nav
        class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 px-8 py-3 flex justify-around items-center rounded-t-[32px] shadow-[0_-10px_30px_rgba(0,0,0,0.08)] z-20">
        <button onclick="switchView('dashboard')" id="nav-dashboard"
            class="nav-button active flex flex-col items-center gap-1 text-gray-300"> <i data-lucide="layout-dashboard"
                class="w-6 h-6"></i> <span class="text-[10px] font-bold">ホーム</span> </button> <button
            onclick="switchView('stats')" id="nav-stats"
            class="nav-button flex flex-col items-center gap-1 text-gray-300"> <i data-lucide="line-chart"
                class="w-6 h-6"></i> <span class="text-[10px] font-bold">統計</span> </button> <button
            onclick="switchView('list')" id="nav-list"
            class="nav-button flex flex-col items-center gap-1 text-gray-300"> <i data-lucide="history"
                class="w-6 h-6"></i> <span class="text-[10px] font-bold">履歴</span> </button>
    </nav>
    <script> // --- State --- 
        let transactions = [
            { id: 1, date: '2026-01-10', category: '食費', amount: 1500, type: 'expense', memo: 'ランチ' }, { id: 2, date: '2026-01-15', category: '給与', amount: 300000, type: 'income', memo: '1月分' }, { id: 3, date: '2026-01-18', category: '趣味', amount: 8000, type: 'expense', memo: '書籍' }, { id: 4, date: '2025-12-25', category: '食費', amount: 5000, type: 'expense', memo: 'クリスマス' }, { id: 5, date: '2025-12-01', category: '住居費', amount: 65000, type: 'expense', memo: '家賃' }, { id: 6, date: '2025-11-15', category: '給与', amount: 280000, type: 'income', memo: '11月分' }, { id: 7, date: '2025-11-20', category: '食費', amount: 45000, type: 'expense', memo: '食費まとめ' }, { id: 8, date: '2025-10-20', category: '趣味', amount: 12000, type: 'expense', memo: '秋の旅行' }]; const CATEGORIES = { expense: ['食費', '日用品', '交通費', '趣味', '住居費', 'その他'], income: ['給与', '賞与', '副業', '臨時収入'] }; const THEME_COLORS = { base: '#aa998a', sub: '#9ec3bc', accent: '#eadfca' }; let currentView = 'dashboard'; let currentFormType = 'expense'; let selectedMonthStr = ""; let expenseChart = null; let trendChart = null;
        // --- Init --- 
        window.onload = () => {
            const now = new Date(); selectedMonthStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`; initMonthSelector(); lucide.createIcons(); document.getElementById('input-date').value = now.toISOString().split('T')[0];
            updateCategoryOptions(); render();
        }; function initMonthSelector() { const selector = document.getElementById('global-month-selector'); selector.innerHTML = ''; const now = new Date(); for (let i = 0; i < 12; i++) { const d = new Date(now.getFullYear(), now.getMonth() - i, 1); const val = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`; const text = `${d.getFullYear()}年 ${d.getMonth() + 1}月`; const opt = document.createElement('option'); opt.value = val; opt.innerText = text; selector.appendChild(opt); } selector.value = selectedMonthStr; } function handleMonthChange() { selectedMonthStr = document.getElementById('global-month-selector').value; render(); }
        // --- Navigation --- 
        function switchView(viewName) {
            currentView = viewName; document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active')); document.getElementById(`view-${viewName}`).classList.add('active'); document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active')); const activeNav = document.getElementById(`nav-${viewName}`); if (activeNav) activeNav.classList.add('active');
            // FAB visibility logic 
            const fab = document.getElementById('fab-add'); if (viewName === 'add') { fab.style.display = 'none'; } else {
                fab.style.display = 'flex';
            } render();
        }
        // --- Logic --- 
        function setFormType(type) { currentFormType = type; const btnExpense = document.getElementById('btn-type-expense'); const btnIncome = document.getElementById('btn-type-income'); if (type === 'expense') { btnExpense.classList.add('bg-white', 'shadow-sm'); btnExpense.classList.remove('text-gray-400'); btnIncome.classList.remove('bg-white', 'shadow-sm'); btnIncome.classList.add('text-gray-400'); } else { btnIncome.classList.add('bg-white', 'shadow-sm'); btnIncome.classList.remove('text-gray-400'); btnExpense.classList.remove('bg-white', 'shadow-sm'); btnExpense.classList.add('text-gray-400'); } updateCategoryOptions(); } function updateCategoryOptions() { const select = document.getElementById('input-category'); select.innerHTML = ''; CATEGORIES[currentFormType].forEach(cat => { const opt = document.createElement('option'); opt.value = cat; opt.innerText = cat; select.appendChild(opt); }); } document.getElementById('transaction-form').onsubmit = (e) => {
            e.preventDefault(); const amount = parseInt(document.getElementById('input-amount').value); const category = document.getElementById('input-category').value; const date = document.getElementById('input-date').value; const memo = document.getElementById('input-memo').value; if (isNaN(amount) || amount <= 0) return; transactions.unshift({
                id: Date.now(), amount, category, date, memo, type: currentFormType
            }); selectedMonthStr = date.substring(0, 7); document.getElementById('global-month-selector').value = selectedMonthStr; document.getElementById('input-amount').value = ''; document.getElementById('input-memo').value = ''; switchView('dashboard');
        }; function deleteTransaction(id) { transactions = transactions.filter(t => t.id !== id); render(); }
        // --- Rendering & Stats --- 
        function render() {
            const filtered = transactions.filter(t => t.date.startsWith(selectedMonthStr)); const summary = filtered.reduce((acc, curr) => { if (curr.type === 'income') { acc.income += curr.amount; acc.total += curr.amount; } else { acc.expense += curr.amount; acc.total -= curr.amount; } return acc; }, { income: 0, expense: 0, total: 0 }); document.getElementById('total-balance').innerText = `¥ ${summary.total.toLocaleString()}`; document.getElementById('summary-income').innerText = `¥ ${summary.income.toLocaleString()}`; document.getElementById('summary-expense').innerText = `¥ ${summary.expense.toLocaleString()}`; const [y, m] = selectedMonthStr.split('-'); document.getElementById('display-month').innerText = `${y}年 ${parseInt(m)}月`;
            // Lists 
            const recentContainer = document.getElementById('recent-list'); recentContainer.innerHTML = '';
            if (filtered.length === 0) { recentContainer.innerHTML = '<p class="text-center py-4 text-xs text-gray-400">今月のデータはありません</p>'; } else { filtered.slice(0, 5).forEach(t => recentContainer.appendChild(createItemElement(t, false))); } const historyContainer = document.getElementById('full-history-list'); historyContainer.innerHTML = ''; transactions.forEach(t => historyContainer.appendChild(createItemElement(t, true)));
            // Charts & Monthly Table 
            updateExpenseDoughnut(filtered); if (currentView === 'stats') { updateTrendChart(); updateMonthlySummaryList(); } lucide.createIcons();
        } function updateExpenseDoughnut(data) {
            const expenseData = data.filter(t => t.type === 'expense'); const categoryTotals = {}; CATEGORIES.expense.forEach(c => categoryTotals[c] = 0); expenseData.forEach(t => categoryTotals[t.category] += t.amount); const labels = Object.keys(categoryTotals).filter(c => categoryTotals[c] > 0); const values = labels.map(l => categoryTotals[l]); const legendDiv = document.getElementById('chart-legend'); legendDiv.innerHTML = ''; if (values.length === 0) { if (expenseChart) expenseChart.destroy(); expenseChart = null; legendDiv.innerHTML = '<p class="col-span-2 text-center py-4 opacity-50">支出データなし</p>'; return; } const colors = [THEME_COLORS.base, THEME_COLORS.sub, '#d1d5db', '#8b7e74', '#789395', '#C4B5A6'];
            labels.forEach((l, i) => { const item = document.createElement('div'); item.className = "flex items-center gap-1"; item.innerHTML = `<span class="w-2 h-2 rounded-full" style="background:${colors[i % colors.length]}"></span> ${l}: ¥${categoryTotals[l].toLocaleString()}`; legendDiv.appendChild(item); }); const ctx = document.getElementById('expenseChart').getContext('2d'); if (expenseChart) expenseChart.destroy(); expenseChart = new Chart(ctx, { type: 'doughnut', data: { labels: labels, datasets: [{ data: values, backgroundColor: colors, borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, cutout: '70%' } });
        } function updateTrendChart() {
            const months = []; const now = new Date(); for (let i = 5; i >= 0; i--) { const d = new Date(now.getFullYear(), now.getMonth() - i, 1); months.push(`${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`); } const expenseData = months.map(m => { return transactions.filter(t => t.date.startsWith(m) && t.type === 'expense').reduce((sum, t) => sum + t.amount, 0); }); const incomeData = months.map(m => {
                return transactions.filter(t => t.date.startsWith(m) && t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            }); const ctx = document.getElementById('trendChart').getContext('2d'); if (trendChart) trendChart.destroy(); trendChart = new Chart(ctx, { type: 'bar', data: { labels: months.map(m => m.split('-')[1] + '月'), datasets: [{ label: '支出', data: expenseData, backgroundColor: THEME_COLORS.base, borderRadius: 8, }, { label: '収入', data: incomeData, backgroundColor: THEME_COLORS.sub, borderRadius: 8, }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { font: { size: 10 } } }, x: { grid: { display: false }, ticks: { font: { size: 10 } } } }, plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: 10 } } } } } });
        } function updateMonthlySummaryList() {
            const container = document.getElementById('monthly-summary-list'); container.innerHTML = '';
            const monthlyMap = {}; transactions.forEach(t => { const m = t.date.substring(0, 7); if (!monthlyMap[m]) monthlyMap[m] = { income: 0, expense: 0 }; if (t.type === 'income') monthlyMap[m].income += t.amount; else monthlyMap[m].expense += t.amount; }); const sortedMonths = Object.keys(monthlyMap).sort().reverse(); sortedMonths.forEach(m => { const data = monthlyMap[m]; const balance = data.income - data.expense; const [y, month] = m.split('-'); const card = document.createElement('div'); card.className = "border-b border-gray-100 pb-3 last:border-0"; card.innerHTML = ` <div class="flex justify-between items-center mb-1"> <span class="font-bold text-sm">${y}年 ${parseInt(month)}月</span> <span class="text-xs font-bold ${balance >= 0 ? 'text-green-600' : 'text-red-500'}"> 収支: ¥${balance.toLocaleString()} </span> </div> <div class="flex gap-4 text-[10px] text-gray-500 font-bold"> <span class="flex items-center gap-1"> <span class="w-1.5 h-1.5 rounded-full bg-sub"></span> 収入: ¥${data.income.toLocaleString()} </span> <span class="flex items-center gap-1"> <span class="w-1.5 h-1.5 rounded-full bg-base"></span> 支出: ¥${data.expense.toLocaleString()} </span> </div> `; container.appendChild(card); });
        } function createItemElement(t, showDelete) {
            const div = document.createElement('div'); div.className = "flex justify-between items-center bg-white p-4 rounded-2xl shadow-sm border border-gray-50";
            const isIncome = t.type === 'income'; div.innerHTML = ` <div class="flex items-center gap-3"> <div class="p-2 rounded-xl" style="background-color: ${isIncome ? 'rgba(158, 195, 188, 0.2)' : 'rgba(170, 153, 138, 0.15)'}"> <i data-lucide="${isIncome ? 'trending-up' : 'trending-down'}" class="w-5 h-5 ${isIncome ? 'text-green-500' : 'text-base'}"></i> </div> <div> <p class="font-bold text-sm">${t.category}</p> <p class="text-[9px] text-gray-400">${t.date} ${t.memo ? `· ${t.memo}` : ''}</p> </div> </div> <div class="flex items-center gap-3"> <p class="font-bold text-sm ${isIncome ? 'text-green-600' : 'text-gray-700'}">${isIncome ? '+' : '-'}¥${t.amount.toLocaleString()}</p> ${showDelete ? `<button onclick="deleteTransaction(${t.id})" class="text-gray-300 hover:text-red-400"><i data-lucide="x" class="w-4 h-4"></i></button>` : ''} </div> `; return div;
        } 
    </script>
</body>

</html>